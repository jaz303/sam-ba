#!/bin/bash

OBJ=$1
BIN=$2
CODE=$(hexdump -v -e '"0x" 1/1 "%02X, "'  ${BIN})
CODE=${CODE::${#CODE}-2}

echo "// WARNING!!! DO NOT EDIT - FILE GENERATED BY APPLETGEN"
echo ""
echo "const impl = {"

nm -g $OBJ | awk '{print "    \""$3"\": 0x"$1","}'

echo "    \$codeBuffer: Buffer.from([${CODE}])"
echo "};"
echo ""
echo "module.exports = impl;"
